@{
    Layout = "_Layout";
}
@model SwipSwapMVC.Models.ViewModels.CheckoutSuccessViewModel

<body class="bg-gray-100 min-h-screen flex justify-center items-start p-6">

    <div class="w-full max-w-7xl mx-auto space-y-10">

        <!-- Success Header -->
        <div class="bg-white shadow rounded-xl p-6 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                </svg>

                <div>
                    <p class="text-green-600 font-semibold">Purchase Successful!</p>
                    <p class="text-gray-500 text-sm">Your item has been confirmed.</p>
                </div>
            </div>

            <a asp-controller="Dashboard" asp-action="Index"
               class="inline-flex items-center gap-2 bg-gray-900 text-white px-5 py-2 rounded-lg text-sm hover:bg-gray-800 transition">
                ← Back to Dashboard
            </a>
        </div>


        <!-- Item + Pickup Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

            <!-- Item Details -->
            <div class="bg-white shadow rounded-xl p-8">
                <h2 class="text-lg font-semibold text-gray-800 mb-4">Item Details</h2>

                <img src="@(!string.IsNullOrEmpty(Model.ImageUrl) ? Model.ImageUrl : "https://placehold.co/600x400")"
                     alt="Item Image"
                     class="w-full rounded-lg mb-6" />

                <h3 class="text-gray-900 font-medium">@Model.ItemName</h3>

                @if (!string.IsNullOrEmpty(Model.Description))
                {
                    <p class="text-gray-500 text-sm mb-6">@Model.Description</p>
                }

                <div class="grid grid-cols-2 gap-x-8 gap-y-4 text-sm text-gray-700">

                    <!-- Amount Paid -->
                    <p class="flex items-center gap-2">
                        <svg class="w-5 h-5 text-green-600 shrink-0 transform scale-90"
                             xmlns="http://www.w3.org/2000/svg"
                             fill="none"
                             viewBox="0 0 24 24"
                             stroke-width="1.5"
                             stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                  d="M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                        </svg>
                        <span class="font-semibold text-green-600">$@Model.AmountPaid</span>
                    </p>

                    <!-- Purchase Date -->
                    <p class="flex items-center gap-2">
                        <svg class="w-5 h-5 text-gray-700" fill="none" stroke="currentColor" stroke-width="2"
                             viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                  d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7H3v12a2 2 0 002 2z" />
                        </svg>
                        @Model.PurchaseDate.ToShortDateString()
                    </p>

                    <!-- Seller -->
                    <p class="flex items-center gap-2">
                        <svg class="w-5 h-5 text-gray-700 shrink-0"
                             xmlns="http://www.w3.org/2000/svg"
                             fill="none"
                             viewBox="0 0 24 24"
                             stroke-width="1.5"
                             stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                  d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                        </svg>
                        @Model.SellerName
                    </p>

                    <!-- Contact -->
                    @if (!string.IsNullOrEmpty(Model.SellerPhone))
                    {
                        <p class="flex items-center gap-2">
                            <svg class="w-5 h-5 text-gray-700" fill="none" stroke="currentColor" stroke-width="2"
                                 viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                      d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25A2.25 2.25
                         0 0021.75 19.5v-1.372a1.125 1.125
                         0 00-.852-1.091l-4.423-1.106a1.125
                         1.125 0 00-1.173.417l-.97 1.293a1.125
                         1.125 0 01-1.21.38A12.035 12.035
                         0 017.026 11.58a1.125 1.125
                         0 01.38-1.21l1.293-.97a1.125
                         1.125 0 00.417-1.173L7.01 3.102A1.125
                         1.125 0 005.918 2.25H4.5A2.25 2.25
                         0 002.25 4.5v2.25Z" />
                            </svg>
                            @Model.SellerPhone
                        </p>
                    }

                    <!-- Location -->
                    @if (!string.IsNullOrEmpty(Model.FullAddress))
                    {
                        <p class="flex items-center gap-2 col-span-2">
                            <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" stroke-width="2"
                                 viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                      d="M12 22s8-4.5 8-11a8 8 0 10-16 0c0 6.5 8 11 8 11zm0-13a3 3 0 110 6 3 3 0 010-6z" />
                            </svg>
                            @Model.FullAddress
                        </p>
                    }


                </div>
            </div>


            <!-- Pickup Location -->
            <div class="bg-white rounded-2xl p-8 shadow flex flex-col">
                <h2 class="text-lg font-semibold text-gray-800 mb-2 text-center">
                     Pickup Location
                </h2>

                @if (Model.Latitude.HasValue && Model.Longitude.HasValue)
                {
                    <iframe width="100%"
                            height="500"
                            class="rounded-xl"
                            style="border:0;"
                            referrerpolicy="no-referrer-when-downgrade"
                            loading="lazy"
                            allowfullscreen
                            src="https://www.google.com/maps?q=@Model.Latitude,@Model.Longitude&hl=en&z=16&output=embed">
                    </iframe>

                }
                else
                {
                    <div class="text-center text-gray-500 py-6 border rounded-xl">
                        Pickup address missing location data
                    </div>
                }



                <a href="https://www.google.com/maps/search/?api=1&query=@Model.Latitude,@Model.Longitude"
                   target="_blank"
                   class="bg-blue-600 text-white px-4 py-3 rounded-lg w-full text-center hover:bg-blue-700 transition text-sm mt-4">
                    Open in Google Maps
                </a>

            </div>
        </div> <!-- end grid of item + pickup -->
        @if (Model.PastPurchases.Any())
        {
            <div class="bg-white shadow rounded-xl p-8">
                <h2 class="text-lg font-semibold text-gray-800 mb-4">Past Purchases</h2>

                <div class="overflow-y-auto max-h-64 border rounded-lg">
                    <table class="w-full text-sm text-gray-700">
                        <thead class="bg-gray-100 text-xs uppercase text-gray-600">
                            <tr>
                                <th class="px-4 py-3 text-left">Order ID</th>
                                <th class="px-4 py-3 text-left">Item Name</th>
                                <th class="px-4 py-3 text-left">Amount Paid</th>
                                <th class="px-4 py-3 text-left">Date</th>
                                <th class="px-4 py-3 text-left">Status</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            @foreach (var p in Model.PastPurchases)
                            {
                                <tr>
                                    <td class="px-4 py-3 font-medium">@p.OrderId</td>
                                    <td class="px-4 py-3">@p.ItemName</td>
                                    <td class="px-4 py-3 text-green-600 font-semibold">
                                        $@p.AmountPaid
                                    </td>
                                    <td class="px-4 py-3">
                                        @p.PurchaseDate.ToShortDateString()
                                    </td>
                                    <td class="px-4 py-3">
                                        <span class="bg-green-50 text-green-600 text-xs px-3 py-1 rounded-full">
                                            @p.Status
                                        </span>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        }

        </div>

    </div>

</body>
